{% extends 'base.html' %}
{% block title %}My Expenses - Monify{% endblock %}

{% block content %}
<div class="expenses-container">
    <div class="expenses-blur-bg"></div>
    <div class="container">
        <!-- Enhanced Page Header -->
        <div class="expenses-header">
            <div class="header-content">
                <div class="header-icon">
                    <i class="fas fa-receipt"></i>
                </div>
                <h1 class="expenses-title">My Expenses</h1>
                <p class="expenses-subtitle">Track and manage all your expenses with ease</p>
            </div>
        </div>

        <!-- Enhanced Stats Grid -->
        <div class="stats-grid" data-aos="fade-up">
            <div class="stat-card total-amount">
                <div class="stat-icon">
                    <i class="fas fa-wallet"></i>
                </div>
                <div class="stat-content">
                    <h3 class="stat-value">₹{{ "%.2f"|format(total_amount if total_amount else 0) }}</h3>
                    <p class="stat-label">Total Amount</p>
                </div>
            </div>
            
            <div class="stat-card total-expenses">
                <div class="stat-icon">
                    <i class="fas fa-receipt"></i>
                </div>
                <div class="stat-content">
                    <h3 class="stat-value">{{ expenses|length if expenses else 0 }}</h3>
                    <p class="stat-label">Total Expenses</p>
                    <div class="stat-trend neutral">
                        <i class="fas fa-equals"></i>
                        <span>{{ expenses|length if expenses else 0 }} transactions</span>
                    </div>
                </div>
            </div>
            
            <div class="stat-card avg-expense">
                <div class="stat-icon">
                    <i class="fas fa-calculator"></i>
                </div>
                <div class="stat-content">
                    <h3 class="stat-value">
                        {% if expenses and expenses|length > 0 %}
                        ₹{{ "%.2f"|format(total_amount / expenses|length) }}
                        {% else %}
                        ₹0
                        {% endif %}
                    </h3>
                    <p class="stat-label">Average</p>
                </div>
            </div>
            
            <div class="stat-card recurring-expenses">
                <div class="stat-icon">
                    <i class="fas fa-sync-alt"></i>
                </div>
                <div class="stat-content">
                    <h3 class="stat-value">{{ recurring_expenses|length if recurring_expenses else 0 }}</h3>
                    <p class="stat-label">Recurring</p>
                    <div class="stat-trend neutral">
                        <i class="fas fa-clock"></i>
                        <span>Auto-managed</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Action Header -->
        <div class="action-header" data-aos="fade-up" data-aos-delay="100">
            <div class="action-title-section">
                <h3 class="action-title">
                    <i class="fas fa-list mr-2"></i>Expense Management
                </h3>
                <span class="expense-count">{{ expenses|length if expenses else 0 }} expenses</span>
            </div>
            
            <div class="action-buttons">
                <a href="{{ url_for('add_expense') }}" class="action-btn action-btn-primary">
                    <i class="fas fa-plus mr-2"></i>Add New
                </a>
                <a href="{{ url_for('export_csv') }}" class="action-btn action-btn-outline">
                    <i class="fas fa-download mr-2"></i>Export
                </a>
                <button class="action-btn action-btn-outline" onclick="toggleFilters()">
                    <i class="fas fa-filter mr-2"></i>Filter
                </button>
            </div>
        </div>

        <!-- Enhanced Tab Navigation -->
        <div class="tab-navigation" data-aos="fade-up" data-aos-delay="200">
            <nav class="nav nav-pills expenses-nav" id="expenseTabs" role="tablist">
                <a class="nav-link active" id="all-expenses-tab" data-toggle="pill" href="#all-expenses" role="tab">
                    <i class="fas fa-list mr-2"></i>All Expenses
                    <span class="nav-badge">{{ expenses|length if expenses else 0 }}</span>
                </a>
                <a class="nav-link" id="recurring-tab" data-toggle="pill" href="#recurring" role="tab">
                    <i class="fas fa-sync-alt mr-2"></i>Recurring
                    <span class="nav-badge">{{ recurring_expenses|length if recurring_expenses else 0 }}</span>
                    {% if due_expenses and due_expenses|length > 0 %}
                    <span class="nav-badge nav-badge-warning">{{ due_expenses|length }} due</span>
                    {% endif %}
                </a>
            </nav>
        </div>

        <!-- Tab Content -->
        <div class="tab-content" id="expenseTabContent">
            <!-- All Expenses Tab -->
            <div class="tab-pane fade show active" id="all-expenses" role="tabpanel">
                <!-- Due Expenses Alert -->
                {% if due_expenses and due_expenses|length > 0 %}
                <div class="alert-card alert-warning" data-aos="fade-up" data-aos-delay="300">
                    <div class="alert-header">
                        <div class="alert-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="alert-content">
                            <h6>{{ due_expenses|length }} Recurring Expense(s) Due!</h6>
                            <p>Process these recurring expenses to keep your tracking up to date</p>
                        </div>
                    </div>
                    <div class="due-expenses-list">
                        {% for expense in due_expenses[:3] %}
                        <div class="due-expense-item">
                            <div class="due-expense-info">
                                <strong>{{ expense.description }}</strong>
                                <span class="due-amount">₹{{ "%.2f"|format(expense.amount) }}</span>
                            </div>
                            <button onclick="processRecurring({{ expense.id }})" class="btn btn-success btn-sm">
                                <i class="fas fa-check mr-1"></i>Process
                            </button>
                        </div>
                        {% endfor %}
                    </div>
                    <div class="alert-actions">
                        <a href="#recurring" class="btn btn-outline-warning btn-sm" data-toggle="pill">
                            <i class="fas fa-cog mr-1"></i>Manage Recurring
                        </a>
                    </div>
                </div>
                {% endif %}

                <!-- Enhanced Search & Filter -->
                <div class="filter-card" id="filterCard" data-aos="fade-up" data-aos-delay="400" style="display: none;">
                    <div class="filter-header">
                        <h5 class="filter-title">
                            <i class="fas fa-search mr-2"></i>Find & Filter Expenses
                        </h5>
                        <div class="filter-toggle">
                            <button class="btn btn-outline-primary btn-sm" onclick="clearAllFilters()">
                                <i class="fas fa-times mr-1"></i>Clear All
                            </button>
                        </div>
                    </div>
                    
                    <form method="GET" id="filterForm">
                        <div class="filter-grid">
                            <div class="filter-group">
                                <label class="filter-label">Search Expenses</label>
                                <div class="input-with-icon">
                                    <input type="text" name="search" class="filter-input" 
                                           placeholder="Search by description..." 
                                           value="{{ search if search else '' }}">
                                    <i class="fas fa-search input-icon"></i>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <label class="filter-label">Category</label>
                                <div class="input-with-icon">
                                    <select name="category" class="filter-input filter-select">
                                        <option value="">All Categories</option>
                                        {% if categories %}
                                        {% for cat in categories %}
                                        <option value="{{ cat.id }}" 
                                                {% if category_filter == cat.id|string %}selected{% endif %}>
                                            {{ cat.name }}
                                        </option>
                                        {% endfor %}
                                        {% endif %}
                                    </select>
                                    <i class="fas fa-tags input-icon"></i>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <label class="filter-label">Sort By</label>
                                <div class="input-with-icon">
                                    <select name="sort" class="filter-input filter-select">
                                        <option value="date_desc" {% if sort_by == 'date_desc' %}selected{% endif %}>
                                            Newest First
                                        </option>
                                        <option value="date_asc" {% if sort_by == 'date_asc' %}selected{% endif %}>
                                            Oldest First
                                        </option>
                                        <option value="amount_desc" {% if sort_by == 'amount_desc' %}selected{% endif %}>
                                            Highest Amount
                                        </option>
                                        <option value="amount_asc" {% if sort_by == 'amount_asc' %}selected{% endif %}>
                                            Lowest Amount
                                        </option>
                                    </select>
                                    <i class="fas fa-sort input-icon"></i>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <label class="filter-label">&nbsp;</label>
                                <button type="submit" class="filter-btn">
                                    <i class="fas fa-filter mr-2"></i>Apply Filter
                                </button>
                            </div>
                        </div>
                        
                        {% if search or category_filter %}
                        <div class="filter-results">
                            <div class="results-info">
                                <i class="fas fa-info-circle mr-2"></i>
                                Showing {{ expenses|length if expenses else 0 }} results
                                {% if search %} for "<strong>{{ search }}</strong>"{% endif %}
                                {% if category_filter %}
                                    {% if categories %}
                                    {% for cat in categories %}
                                        {% if cat.id == category_filter|int %}
                                            in category "<strong>{{ cat.name }}</strong>"
                                        {% endif %}
                                    {% endfor %}
                                    {% endif %}
                                {% endif %}
                                <a href="{{ url_for('expenses') }}" class="btn btn-outline-primary btn-sm ml-3">
                                    <i class="fas fa-times mr-1"></i>Clear Filters
                                </a>
                            </div>
                        </div>
                        {% endif %}
                    </form>
                </div>

                <!-- Enhanced Expenses Table/List -->
                {% if expenses and expenses|length > 0 %}
                <div class="expenses-table-card" data-aos="fade-up" data-aos-delay="500">
                    <div class="expenses-list">
                        {% for expense in expenses %}
                        <div class="expense-row">
                            <div class="expense-main">
                                <div class="expense-date">
                                    <i class="fas fa-calendar-alt"></i>
                                    <span>{{ expense.date.strftime('%b %d, %Y') }}</span>
                                </div>
                                <div class="expense-description">
                                    {% if expense.description.startswith('[Recurring]') or expense.description.startswith('[Auto]') %}
                                        <i class="fas fa-sync-alt text-info"></i>
                                    {% else %}
                                        <i class="fas fa-receipt text-muted"></i>
                                    {% endif %}
                                    <strong>{{ expense.description }}</strong>
                                </div>
                                <div class="expense-category">
                                    {% if expense.category %}
                                    <span class="category-badge" style="background-color: {{ expense.category.color if expense.category.color else '#667eea' }};">
                                        <i class="{{ expense.category.icon if expense.category.icon else 'fas fa-tag' }}"></i>
                                        {{ expense.category.name }}
                                    </span>
                                    {% else %}
                                    <span class="category-badge" style="background-color: #6c757d;">
                                        <i class="fas fa-tag"></i>
                                        General
                                    </span>
                                    {% endif %}
                                </div>
                                <div class="expense-amount">
                                    <span class="amount-value">₹{{ "%.2f"|format(expense.amount) }}</span>
                                </div>
                                <div class="expense-actions">
                                    <a href="{{ url_for('edit_expense', expense_id=expense.id) }}" 
                                       class="action-btn-sm action-btn-edit" title="Edit">
                                        <i class="fas fa-edit"></i>
                                    </a>
                                    <form method="POST" action="{{ url_for('delete_expense', expense_id=expense.id) }}" 
                                          style="display: inline;">
                                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                                        <button type="submit" 
                                                class="action-btn-sm action-btn-delete" 
                                                title="Delete"
                                                onclick="return confirm('Delete this expense?')">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <!-- Enhanced Summary Card -->
                {% if summary_data %}
                <div class="summary-section" data-aos="fade-up" data-aos-delay="600">
                    <div class="summary-card">
                        <div class="summary-header">
                            <h5>
                                <i class="fas fa-chart-bar mr-2"></i>Quick Summary
                            </h5>
                        </div>
                        <div class="summary-grid">
                            <div class="summary-item">
                                <div class="summary-icon">
                                    <i class="fas fa-trophy"></i>
                                </div>
                                <div class="summary-content">
                                    <span class="summary-label">Most Expensive</span>
                                    <span class="summary-value">
                                        {% if summary_data.most_expensive %}
                                            ₹{{ "%.2f"|format(summary_data.most_expensive.amount) }}
                                            <small>({{ summary_data.most_expensive.description }})</small>
                                        {% else %}
                                            -
                                        {% endif %}
                                    </span>
                                </div>
                            </div>
                            
                            <div class="summary-item">
                                <div class="summary-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="summary-content">
                                    <span class="summary-label">Latest Expense</span>
                                    <span class="summary-value">
                                        {% if summary_data.latest_expense %}
                                            {{ summary_data.latest_expense.description }}
                                            <small>({{ summary_data.latest_expense.date.strftime('%b %d') }})</small>
                                        {% else %}
                                            -
                                        {% endif %}
                                    </span>
                                </div>
                            </div>
                            
                            <div class="summary-item">
                                <div class="summary-icon">
                                    <i class="fas fa-calculator"></i>
                                </div>
                                <div class="summary-content">
                                    <span class="summary-label">Average Amount</span>
                                    <span class="summary-value">
                                        ₹{{ "%.2f"|format(summary_data.average_amount if summary_data.average_amount else 0) }}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}

                {% else %}
                <!-- Enhanced Empty State -->
                <div class="empty-state" data-aos="fade-up" data-aos-delay="400">
                    <div class="empty-icon">
                        <i class="fas fa-receipt"></i>
                    </div>
                    <h4 class="empty-title">No expenses found</h4>
                    <p class="empty-description">
                        {% if search or category_filter %}
                            Try adjusting your search criteria or clear all filters to see your expenses
                        {% else %}
                            Start by adding your first expense to begin tracking your spending journey!
                        {% endif %}
                    </p>
                    <div class="empty-actions">
                        <a href="{{ url_for('add_expense') }}" class="btn btn-primary btn-lg">
                            <i class="fas fa-plus mr-2"></i>Add Your First Expense
                        </a>
                        {% if search or category_filter %}
                        <a href="{{ url_for('expenses') }}" class="btn btn-outline-primary btn-lg ml-3">
                            <i class="fas fa-times mr-2"></i>Clear Filters
                        </a>
                        {% endif %}
                    </div>
                </div>
                {% endif %}
            </div>

            <!-- Recurring Expenses Tab -->
            <div class="tab-pane fade" id="recurring" role="tabpanel">
                <!-- Recurring Expenses Header -->
                <div class="recurring-header" data-aos="fade-up" data-aos-delay="300">
                    <div class="recurring-title-section">
                        <h4 class="recurring-title">
                            <i class="fas fa-sync-alt mr-2"></i>Recurring Expenses
                        </h4>
                        <p class="recurring-subtitle">Automatically track your regular expenses</p>
                    </div>
                    <div class="recurring-actions">
                        <button class="action-btn action-btn-primary" onclick="showRecurringForm()">
                            <i class="fas fa-plus mr-2"></i>Add Recurring
                        </button>
                        {% if due_expenses and due_expenses|length > 0 %}
                        <button class="action-btn action-btn-outline" onclick="processAllDue()">
                            <i class="fas fa-check-double mr-2"></i>Process All Due
                        </button>
                        {% endif %}
                    </div>
                </div>

                <!-- Recurring Stats -->
                <div class="recurring-stats" data-aos="fade-up" data-aos-delay="400">
                    <div class="recurring-stats-grid">
                        <div class="recurring-stat-card">
                            <div class="recurring-stat-icon">
                                <i class="fas fa-sync-alt"></i>
                            </div>
                            <div class="recurring-stat-content">
                                <h4>{{ recurring_expenses|length if recurring_expenses else 0 }}</h4>
                                <p>Active Recurring</p>
                            </div>
                        </div>
                        
                        <div class="recurring-stat-card due">
                            <div class="recurring-stat-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="recurring-stat-content">
                                <h4>{{ due_expenses|length if due_expenses else 0 }}</h4>
                                <p>Due Now</p>
                            </div>
                        </div>
                        
                        
                    </div>
                </div>

                <!-- Due Expenses Section -->
                {% if due_expenses and due_expenses|length > 0 %}
                <div class="due-section" data-aos="fade-up" data-aos-delay="500">
                    <div class="section-header">
                        <h5 class="section-title">
                            <i class="fas fa-exclamation-circle mr-2 text-warning"></i>
                            Due Expenses ({{ due_expenses|length }})
                        </h5>
                    </div>
                    
                    <div class="due-expenses-card">
                        {% for expense in due_expenses %}
                        <div class="due-expense-row">
                            <div class="due-expense-main">
                                <div class="due-expense-info">
                                    <div class="due-expense-title">
                                        <i class="fas fa-sync-alt text-warning mr-2"></i>
                                        <strong>{{ expense.description }}</strong>
                                    </div>
                                    <div class="due-expense-details">
                                        <span class="due-category">
                                            {% if expense.category %}
                                                <i class="{{ expense.category.icon if expense.category.icon else 'fas fa-tag' }}"></i>
                                                {{ expense.category.name }}
                                            {% else %}
                                                <i class="fas fa-tag"></i>
                                                General
                                            {% endif %}
                                        </span>
                                        <span class="due-frequency">
                                            {{ expense.frequency.title() if expense.frequency else 'Monthly' }}
                                        </span>
                                    </div>
                                </div>
                                
                                <div class="due-expense-amount">
                                    <span class="amount-value">₹{{ "%.2f"|format(expense.amount) }}</span>
                                    <span class="due-date">Due: Now</span>
                                </div>
                                
                                <div class="due-expense-actions">
                                    <button onclick="processRecurring({{ expense.id }})" 
                                            class="action-btn-sm action-btn-success" title="Process Now">
                                        <i class="fas fa-check"></i>
                                    </button>
                                    <button class="action-btn-sm action-btn-outline" 
                                            onclick="editRecurring({{ expense.id }})" title="Edit">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                <!-- All Recurring Expenses Section -->
                <div class="all-recurring-section" data-aos="fade-up" data-aos-delay="600">
                    <div class="section-header">
                        <h5 class="section-title">
                            <i class="fas fa-list mr-2"></i>All Recurring Expenses 
                            ({{ recurring_expenses|length if recurring_expenses else 0 }})
                        </h5>
                    </div>
                    
                    {% if recurring_expenses and recurring_expenses|length > 0 %}
                    <div class="recurring-expenses-card">
                        <div class="recurring-expenses-list">
                            {% for expense in recurring_expenses %}
                            <div class="recurring-expense-row">
                                <div class="recurring-expense-main">
                                    <div class="recurring-expense-status">
                                        {% if expense in due_expenses %}
                                            <div class="status-indicator status-due">
                                                <i class="fas fa-clock"></i>
                                                <span>Due</span>
                                            </div>
                                        {% else %}
                                            <div class="status-indicator status-active">
                                                <i class="fas fa-check-circle"></i>
                                                <span>Active</span>
                                            </div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="recurring-expense-info">
                                        <div class="recurring-expense-title">
                                            <strong>{{ expense.description }}</strong>
                                            <span class="frequency-badge frequency-{{ expense.frequency if expense.frequency else 'monthly' }}">
                                                {{ expense.frequency.title() if expense.frequency else 'Monthly' }}
                                            </span>
                                        </div>
                                        <div class="recurring-expense-details">
                                            <span class="recurring-category">
                                                {% if expense.category %}
                                                    <i class="{{ expense.category.icon if expense.category.icon else 'fas fa-tag' }}"></i>
                                                    {{ expense.category.name }}
                                                {% else %}
                                                    <i class="fas fa-tag"></i>
                                                    General
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <div class="recurring-expense-amount">
                                        <span class="amount-value">₹{{ "%.2f"|format(expense.amount) }}</span>
                                        <span class="amount-frequency">
                                            per {{ expense.frequency if expense.frequency else 'month' }}
                                        </span>
                                    </div>
                                    
                                    <div class="recurring-expense-actions">
                                        {% if expense in due_expenses %}
                                        <button onclick="processRecurring({{ expense.id }})" 
                                                class="action-btn-sm action-btn-success" title="Process Now">
                                            <i class="fas fa-play"></i>
                                        </button>
                                        {% endif %}
                                        <button class="action-btn-sm action-btn-outline" 
                                                onclick="editRecurring({{ expense.id }})" title="Edit">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="action-btn-sm action-btn-delete" 
                                                onclick="deleteRecurring({{ expense.id }})" title="Delete">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% else %}
                    <!-- Empty Recurring State -->
                    <div class="empty-recurring-state">
                        <div class="empty-icon">
                            <i class="fas fa-sync-alt"></i>
                        </div>
                        <h4>No Recurring Expenses Set Up</h4>
                        <p>Automate your regular expenses like rent, utilities, subscriptions, and more!</p>
                        <div class="empty-actions">
                            <button class="btn btn-primary btn-lg" onclick="showRecurringForm()">
                                <i class="fas fa-plus mr-2"></i>Add Your First Recurring Expense
                            </button>
                        </div>
                        
                        <div class="benefits-grid">
                            <div class="benefit-item">
                                <i class="fas fa-clock"></i>
                                <span>Never forget regular payments</span>
                            </div>
                            <div class="benefit-item">
                                <i class="fas fa-chart-line"></i>
                                <span>Better budget planning</span>
                            </div>
                            <div class="benefit-item">
                                <i class="fas fa-magic"></i>
                                <span>Automatic expense tracking</span>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add Recurring Expense Modal -->
<div class="modal fade" id="addRecurringModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-sync-alt mr-2"></i>Add Recurring Expense
                </h5>
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form method="POST" action="#" id="recurringForm" onsubmit="handleRecurringSubmit(event)">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <div class="modal-body">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Description</label>
                            <div class="input-with-icon">
                                <input type="text" name="description" class="form-input" 
                                       placeholder="e.g., Monthly Rent" required>
                                <i class="fas fa-align-left input-icon"></i>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Amount</label>
                            <div class="input-with-currency">
                                <span class="currency-symbol">₹</span>
                                <input type="number" name="amount" class="form-input form-input-currency" 
                                       placeholder="0.00" step="0.01" min="0" required>
                                <i class="fas fa-rupee-sign input-icon-currency"></i>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Category</label>
                            <div class="input-with-icon">
                                <select name="category_id" class="form-input form-select" required>
                                    <option value="">Select Category</option>
                                    {% if categories %}
                                    {% for category in categories %}
                                    <option value="{{ category.id }}">{{ category.name }}</option>
                                    {% endfor %}
                                    {% endif %}
                                </select>
                                <i class="fas fa-tags input-icon"></i>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Frequency</label>
                            <div class="input-with-icon">
                                <select name="frequency" class="form-input form-select" required>
                                    <option value="">Select Frequency</option>
                                    <option value="daily">Daily</option>
                                    <option value="weekly">Weekly</option>
                                    <option value="monthly">Monthly</option>
                                    <option value="yearly">Yearly</option>
                                </select>
                                <i class="fas fa-calendar-alt input-icon"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">
                        <i class="fas fa-times mr-2"></i>Cancel
                    </button>
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-plus mr-2"></i>Add Recurring Expense
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<style>
/* Enhanced Expenses Page - Consistent Design */
.expenses-container {
    position: relative;
    min-height: 100vh;
    background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
    padding: 40px 0;
    font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;
}

.expenses-blur-bg {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="25" cy="25" r="1.5" fill="rgba(102,126,234,0.06)"/><circle cx="75" cy="45" r="2" fill="rgba(118,75,162,0.04)"/><circle cx="50" cy="75" r="1" fill="rgba(102,126,234,0.05)"/><circle cx="20" cy="80" r="1.2" fill="rgba(118,75,162,0.03)"/></svg>');
}

/* Enhanced Header */
.expenses-header {
    text-align: center;
    margin-bottom: 50px;
    position: relative;
    z-index: 2;
}

.header-content {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 40px;
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(0, 0, 0, 0.06);
    max-width: 600px;
    margin: 0 auto;
}

.header-icon {
    width: 80px;
    height: 80px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 25px;
    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
}

.header-icon i {
    font-size: 2rem;
    color: white;
}

.expenses-title {
    font-size: 2.5rem;
    font-weight: 700;
    color: #2D3748;
    margin-bottom: 15px;
    letter-spacing: -0.5px;
}

.expenses-subtitle {
    font-size: 1.1rem;
    color: #718096;
    margin: 0;
    line-height: 1.6;
}

/* Stats Grid */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 25px;
    margin-bottom: 50px;
    position: relative;
    z-index: 2;
}

.stat-card {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 30px;
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(0, 0, 0, 0.06);
    display: flex;
    align-items: center;
    gap: 20px;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.stat-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #667eea, #764ba2);
}

.stat-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 25px 50px rgba(0, 0, 0, 0.12);
}

.stat-icon {
    width: 70px;
    height: 70px;
    border-radius: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.8rem;
    color: white;
    flex-shrink: 0;
}

.total-amount .stat-icon {
    background: linear-gradient(135deg, #667eea, #764ba2);
}

.total-expenses .stat-icon {
    background: linear-gradient(135deg, #28a745, #20c997);
}

.avg-expense .stat-icon {
    background: linear-gradient(135deg, #e74c3c, #fd79a8);
}

.recurring-expenses .stat-icon {
    background: linear-gradient(135deg, #ffa726, #ff9800);
}

.stat-content {
    flex: 1;
}

.stat-value {
    font-size: 2.2rem;
    font-weight: 700;
    color: #2D3748;
    margin-bottom: 8px;
    line-height: 1;
}

.stat-label {
    color: #718096;
    font-size: 1rem;
    margin-bottom: 10px;
    font-weight: 500;
}

.stat-trend {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.85rem;
    font-weight: 500;
}

.stat-trend.up {
    color: #28a745;
}

.stat-trend.down {
    color: #dc3545;
}

.stat-trend.neutral {
    color: #6c757d;
}

/* Action Header */
.action-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    position: relative;
    z-index: 2;
}

.action-title-section {
    display: flex;
    align-items: center;
    gap: 15px;
}

.action-title {
    font-size: 1.5rem;
    font-weight: 600;
    color: #2D3748;
    margin: 0;
}

.expense-count {
    background: #e9ecef;
    color: #6c757d;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 500;
}

.action-buttons {
    display: flex;
    gap: 12px;
}

.action-btn {
    padding: 12px 20px;
    border-radius: 12px;
    font-weight: 600;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    transition: all 0.3s ease;
    border: none;
    cursor: pointer;
}

.action-btn-primary {
    background: linear-gradient(135deg, #28a745, #20c997);
    color: white;
    box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
}

.action-btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
    color: white;
    text-decoration: none;
}

.action-btn-outline {
    background: transparent;
    color: #667eea;
    border: 2px solid #667eea;
}

.action-btn-outline:hover {
    background: #667eea;
    color: white;
    text-decoration: none;
}

/* Tab Navigation */
.tab-navigation {
    margin-bottom: 30px;
    position: relative;
    z-index: 2;
}

.expenses-nav {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 8px;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(0, 0, 0, 0.06);
}

.expenses-nav .nav-link {
    border-radius: 15px;
    padding: 15px 25px;
    color: #667eea;
    font-weight: 600;
    border: none;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
}

.expenses-nav .nav-link.active {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.expenses-nav .nav-link:hover:not(.active) {
    background: rgba(102, 126, 234, 0.1);
    color: #667eea;
}

.nav-badge {
    background: rgba(255, 255, 255, 0.2);
    color: currentColor;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 600;
}

.nav-badge-warning {
    background: #ffc107;
    color: #856404;
}

/* Alert Card */
.alert-card {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-radius: 16px;
    padding: 25px;
    margin-bottom: 30px;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(0, 0, 0, 0.06);
    position: relative;
    z-index: 2;
}

.alert-warning {
    border-left: 4px solid #ffc107;
    background: linear-gradient(135deg, rgba(255, 193, 7, 0.05), rgba(255, 255, 255, 0.95));
}

.alert-header {
    display: flex;
    align-items: center;
    margin-bottom: 20px;
}

.alert-icon {
    width: 50px;
    height: 50px;
    background: #ffc107;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.3rem;
    margin-right: 15px;
}

.alert-content h6 {
    font-size: 1.2rem;
    font-weight: 600;
    color: #2D3748;
    margin-bottom: 5px;
}

.alert-content p {
    color: #718096;
    margin: 0;
}

/* Filter Card */
.filter-card {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 30px;
    margin-bottom: 30px;
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(0, 0, 0, 0.06);
    position: relative;
    z-index: 2;
}

.filter-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
}

.filter-title {
    font-size: 1.3rem;
    font-weight: 600;
    color: #2D3748;
    margin: 0;
}

.filter-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    align-items: end;
}

.filter-group {
    display: flex;
    flex-direction: column;
}

.filter-label {
    font-size: 0.9rem;
    font-weight: 600;
    color: #2D3748;
    margin-bottom: 8px;
}

.input-with-icon {
    position: relative;
}

.filter-input {
    width: 100%;
    padding: 12px 16px 12px 45px;
    border: 2px solid #E2E8F0;
    border-radius: 10px;
    font-size: 0.95rem;
    transition: all 0.3s ease;
    background: white;
    color: #2D3748;
}

.filter-input:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.input-icon {
    position: absolute;
    left: 16px;
    top: 50%;
    transform: translateY(-50%);
    color: #A0AEC0;
    font-size: 1rem;
}

.filter-select {
    appearance: none;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
    background-position: right 12px center;
    background-repeat: no-repeat;
    background-size: 16px 12px;
    padding-right: 45px;
}

.filter-btn {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 10px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
}

.filter-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
}

/* Expenses List */
.expenses-table-card {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 30px;
    margin-bottom: 30px;
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(0, 0, 0, 0.06);
    position: relative;
    z-index: 2;
}

.expense-row {
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    transition: all 0.3s ease;
    position: relative;
}

.expense-row:hover {
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.02), rgba(118, 75, 162, 0.02));
    transform: translateX(5px);
}

.expense-row:hover::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 4px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 0 2px 2px 0;
}

.expense-main {
    display: grid;
    grid-template-columns: 150px 1fr 200px 120px 100px;
    gap: 20px;
    align-items: center;
    padding: 20px;
}

.expense-date {
    display: flex;
    align-items: center;
    gap: 8px;
    color: #718096;
    font-size: 0.9rem;
}

.expense-description {
    display: flex;
    align-items: center;
    gap: 10px;
}

.expense-description strong {
    color: #2D3748;
    font-weight: 600;
}

.category-badge {
    color: white;
    padding: 6px 12px;
    border-radius: 12px;
    font-size: 0.85rem;
    font-weight: 500;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.amount-value {
    font-size: 1.1rem;
    font-weight: 700;
    color: #28a745;
}

.expense-actions {
    display: flex;
    gap: 8px;
}

.action-btn-sm {
    width: 36px;
    height: 36px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    border: none;
    cursor: pointer;
    text-decoration: none;
}

.action-btn-edit {
    background: #667eea;
    color: white;
}

.action-btn-edit:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    color: white;
    text-decoration: none;
}

.action-btn-delete {
    background: #dc3545;
    color: white;
}

.action-btn-delete:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
}

.action-btn-success {
    background: #28a745;
    color: white;
}

.action-btn-success:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
    color: white;
    text-decoration: none;
}

/* Summary Section */
.summary-section {
    position: relative;
    z-index: 2;
}

.summary-card {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 30px;
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(0, 0, 0, 0.06);
}

.summary-header {
    text-align: center;
    margin-bottom: 25px;
}

.summary-header h5 {
    font-size: 1.3rem;
    font-weight: 600;
    color: #2D3748;
    margin: 0;
}

.summary-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 25px;
}

.summary-item {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 20px;
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.03), rgba(118, 75, 162, 0.03));
    border-radius: 15px;
}

.summary-icon {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.2rem;
}

.summary-content {
    flex: 1;
}

.summary-label {
    display: block;
    font-size: 0.9rem;
    color: #718096;
    font-weight: 500;
    margin-bottom: 5px;
}

.summary-value {
    font-size: 1.1rem;
    font-weight: 600;
    color: #2D3748;
}

.summary-value small {
    display: block;
    font-size: 0.85rem;
    color: #718096;
    font-weight: 400;
    margin-top: 2px;
}

/* Empty State */
.empty-state {
    text-align: center;
    padding: 80px 20px;
    position: relative;
    z-index: 2;
}

.empty-icon {
    width: 120px;
    height: 120px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 30px;
    font-size: 3rem;
    color: white;
    box-shadow: 0 15px 35px rgba(102, 126, 234, 0.3);
}

.empty-title {
    font-size: 2rem;
    font-weight: 700;
    color: #2D3748;
    margin-bottom: 15px;
}

.empty-description {
    font-size: 1.1rem;
    color: #718096;
    margin-bottom: 40px;
    max-width: 500px;
    margin-left: auto;
    margin-right: auto;
    line-height: 1.6;
}

.empty-actions {
    display: flex;
    gap: 15px;
    justify-content: center;
    flex-wrap: wrap;
}

/* Due Expenses */
.due-expenses-list {
    margin: 20px 0;
}

.due-expense-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 0;
    border-bottom: 1px solid rgba(255, 193, 7, 0.2);
}

.due-expense-item:last-child {
    border-bottom: none;
}

.due-expense-info {
    display: flex;
    flex-direction: column;
    gap: 5px;
}

.due-amount {
    font-weight: 600;
    color: #28a745;
}

.alert-actions {
    margin-top: 20px;
}

/* Filter Results */
.filter-results {
    margin-top: 20px;
    padding-top: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.06);
}

.results-info {
    background: rgba(102, 126, 234, 0.05);
    padding: 15px 20px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 15px;
    color: #2D3748;
}

/* Recurring Expenses Styles */
.recurring-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 30px;
    position: relative;
    z-index: 2;
}

.recurring-title-section {
    flex: 1;
}

.recurring-title {
    font-size: 1.8rem;
    font-weight: 600;
    color: #2D3748;
    margin-bottom: 10px;
}

.recurring-subtitle {
    color: #718096;
    font-size: 1rem;
    margin: 0;
}

.recurring-actions {
    display: flex;
    gap: 12px;
}

/* Recurring Stats */
.recurring-stats {
    margin-bottom: 40px;
    position: relative;
    z-index: 2;
}

.recurring-stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
}

.recurring-stat-card {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-radius: 16px;
    padding: 25px;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(0, 0, 0, 0.06);
    display: flex;
    align-items: center;
    gap: 15px;
    transition: all 0.3s ease;
}

.recurring-stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
}

.recurring-stat-card.due {
    border-left: 4px solid #ffc107;
}

.recurring-stat-card.monthly {
    border-left: 4px solid #28a745;
}

.recurring-stat-icon {
    width: 50px;
    height: 50px;
    border-radius: 12px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.3rem;
}

.recurring-stat-card.due .recurring-stat-icon {
    background: linear-gradient(135deg, #ffc107, #fd7e14);
}

.recurring-stat-card.monthly .recurring-stat-icon {
    background: linear-gradient(135deg, #28a745, #20c997);
}

.recurring-stat-content h4 {
    font-size: 1.8rem;
    font-weight: 700;
    color: #2D3748;
    margin-bottom: 5px;
}

.recurring-stat-content p {
    color: #718096;
    margin: 0;
    font-size: 0.9rem;
    font-weight: 500;
}

/* Due Section */
.due-section {
    margin-bottom: 40px;
    position: relative;
    z-index: 2;
}

.due-expenses-card {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 30px;
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(0, 0, 0, 0.06);
    border-left: 4px solid #ffc107;
}

.due-expense-row {
    border-bottom: 1px solid rgba(255, 193, 7, 0.2);
    transition: all 0.3s ease;
}

.due-expense-row:last-child {
    border-bottom: none;
}

.due-expense-row:hover {
    background: rgba(255, 193, 7, 0.05);
    transform: translateX(5px);
}

.due-expense-main {
    display: grid;
    grid-template-columns: 1fr auto auto;
    gap: 20px;
    align-items: center;
    padding: 20px 0;
}

.due-expense-info {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.due-expense-title {
    display: flex;
    align-items: center;
    font-size: 1.1rem;
}

.due-expense-details {
    display: flex;
    gap: 15px;
    font-size: 0.9rem;
    color: #718096;
}

.due-category {
    display: flex;
    align-items: center;
    gap: 5px;
}

.due-frequency {
    background: #e9ecef;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 0.8rem;
}

.due-expense-amount {
    text-align: center;
}

.due-expense-amount .amount-value {
    display: block;
    font-size: 1.3rem;
    font-weight: 700;
    color: #ffc107;
    margin-bottom: 5px;
}

.due-date {
    font-size: 0.85rem;
    color: #718096;
}

.due-expense-actions {
    display: flex;
    gap: 8px;
}

/* All Recurring Section */
.all-recurring-section {
    position: relative;
    z-index: 2;
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
}

.section-title {
    font-size: 1.3rem;
    font-weight: 600;
    color: #2D3748;
    margin: 0;
}

.recurring-expenses-card {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 30px;
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(0, 0, 0, 0.06);
}

.recurring-expense-row {
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    transition: all 0.3s ease;
}

.recurring-expense-row:hover {
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.02), rgba(118, 75, 162, 0.02));
    transform: translateX(5px);
}

.recurring-expense-main {
    display: grid;
    grid-template-columns: 100px 1fr auto auto;
    gap: 20px;
    align-items: center;
    padding: 20px 0;
}

.status-indicator {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
    padding: 10px;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 600;
}

.status-due {
    background: rgba(255, 193, 7, 0.1);
    color: #856404;
}

.status-active {
    background: rgba(40, 167, 69, 0.1);
    color: #155724;
}

.recurring-expense-info {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.recurring-expense-title {
    display: flex;
    align-items: center;
    gap: 10px;
    flex-wrap: wrap;
}

.frequency-badge {
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
}

.frequency-daily {
    background: #e74c3c;
    color: white;
}

.frequency-weekly {
    background: #3498db;
    color: white;
}

.frequency-monthly {
    background: #2ecc71;
    color: white;
}

.frequency-yearly {
    background: #9b59b6;
    color: white;
}

.recurring-expense-details {
    display: flex;
    gap: 15px;
    font-size: 0.9rem;
    color: #718096;
}

.recurring-category {
    display: flex;
    align-items: center;
    gap: 5px;
}

.recurring-expense-amount {
    text-align: center;
}

.recurring-expense-amount .amount-value {
    display: block;
    font-size: 1.2rem;
    font-weight: 700;
    color: #28a745;
    margin-bottom: 5px;
}

.amount-frequency {
    font-size: 0.8rem;
    color: #718096;
}

.recurring-expense-actions {
    display: flex;
    gap: 6px;
}

/* Empty Recurring State */
.empty-recurring-state {
    text-align: center;
    padding: 80px 20px;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(0, 0, 0, 0.06);
}

.empty-recurring-state .empty-icon {
    width: 100px;
    height: 100px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 30px;
    font-size: 2.5rem;
    color: white;
    box-shadow: 0 15px 35px rgba(102, 126, 234, 0.3);
}

.empty-recurring-state h4 {
    font-size: 1.8rem;
    font-weight: 700;
    color: #2D3748;
    margin-bottom: 15px;
}

.empty-recurring-state p {
    font-size: 1.1rem;
    color: #718096;
    margin-bottom: 40px;
    max-width: 450px;
    margin-left: auto;
    margin-right: auto;
    line-height: 1.6;
}

.benefits-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-top: 40px;
}

.benefit-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 15px;
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
    border-radius: 12px;
    color: #2D3748;
}

.benefit-item i {
    color: #667eea;
    font-size: 1.2rem;
}

/* Modal Styles */
.modal-content {
    border-radius: 20px;
    border: none;
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
}

.modal-header {
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    border-radius: 20px 20px 0 0;
    padding: 25px 30px;
}

.modal-title {
    font-size: 1.3rem;
    font-weight: 600;
    color: #2D3748;
}

.modal-body {
    padding: 30px;
}

.form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
}

.form-group {
    display: flex;
    flex-direction: column;
}

.form-label {
    display: block;
    font-weight: 600;
    color: #2D3748;
    margin-bottom: 10px;
    font-size: 0.95rem;
}

.form-input {
    width: 100%;
    padding: 16px 18px 16px 50px;
    border: 2px solid #E2E8F0;
    border-radius: 12px;
    font-size: 1rem;
    transition: all 0.3s ease;
    background: white;
    color: #2D3748;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
}

.form-input:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
    background: white;
    transform: translateY(-1px);
}

.input-with-currency {
    position: relative;
    display: flex;
    align-items: center;
}

.currency-symbol {
    position: absolute;
    left: 18px;
    top: 50%;
    transform: translateY(-50%);
    color: #667eea;
    font-weight: 600;
    font-size: 1.1rem;
    z-index: 3;
}

.form-input-currency {
    padding-left: 50px !important;
    padding-right: 50px !important;
}

.input-icon-currency {
    position: absolute;
    right: 18px;
    top: 50%;
    transform: translateY(-50%);
    color: #A0AEC0;
    font-size: 1rem;
    transition: color 0.3s ease;
}

.form-select {
    appearance: none;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
    background-position: right 12px center;
    background-repeat: no-repeat;
    background-size: 16px 12px;
    padding-right: 50px !important;
}

.modal-footer {
    border-top: 1px solid rgba(0, 0, 0, 0.06);
    padding: 20px 30px;
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .expenses-container {
        padding: 20px 0;
    }
    
    .header-content {
        padding: 30px 25px;
    }
    
    .expenses-title {
        font-size: 2rem;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
    
    .action-header {
        flex-direction: column;
        gap: 20px;
        text-align: center;
    }
    
    .action-buttons {
        flex-wrap: wrap;
        justify-content: center;
    }
    
    .filter-grid {
        grid-template-columns: 1fr;
    }
    
    .expense-main {
        grid-template-columns: 1fr;
        gap: 15px;
        text-align: center;
    }
    
    .expense-actions {
        justify-content: center;
    }
    
    .summary-grid {
        grid-template-columns: 1fr;
    }
    
    .summary-item {
        flex-direction: column;
        text-align: center;
    }
    
    .recurring-header {
        flex-direction: column;
        gap: 20px;
        text-align: center;
    }
    
    .recurring-actions {
        flex-wrap: wrap;
        justify-content: center;
    }
    
    .due-expense-main,
    .recurring-expense-main {
        grid-template-columns: 1fr;
        gap: 15px;
        text-align: center;
    }
    
    .due-expense-actions,
    .recurring-expense-actions {
        justify-content: center;
    }
    
    .section-header {
        flex-direction: column;
        gap: 15px;
        text-align: center;
    }
    
    .benefits-grid {
        grid-template-columns: 1fr;
    }
    
    .form-grid {
        grid-template-columns: 1fr;
    }
    
    .results-info {
        flex-direction: column;
        text-align: center;
    }
}

/* Button Styles */
.btn {
    padding: 8px 16px;
    border-radius: 8px;
    font-weight: 500;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    transition: all 0.3s ease;
    border: none;
    cursor: pointer;
}

.btn-primary {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
    color: white;
    text-decoration: none;
}

.btn-outline-primary {
    background: transparent;
    color: #667eea;
    border: 2px solid #667eea;
}

.btn-outline-primary:hover {
    background: #667eea;
    color: white;
    text-decoration: none;
}

.btn-success {
    background: linear-gradient(135deg, #28a745, #20c997);
    color: white;
}

.btn-success:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(40, 167, 69, 0.3);
    color: white;
    text-decoration: none;
}

.btn-outline-warning {
    background: transparent;
    color: #ffc107;
    border: 2px solid #ffc107;
}

.btn-outline-warning:hover {
    background: #ffc107;
    color: #212529;
    text-decoration: none;
}

.btn-outline-secondary {
    background: transparent;
    color: #6c757d;
    border: 2px solid #6c757d;
}

.btn-outline-secondary:hover {
    background: #6c757d;
    color: white;
    text-decoration: none;
}

.btn-lg {
    padding: 12px 24px;
    font-size: 1.1rem;
}

.btn-sm {
    padding: 6px 12px;
    font-size: 0.9rem;
}
</style>

<!-- Animation Library -->
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

<script>
// Initialize animations
AOS.init({
    duration: 800,
    once: true,
    offset: 50
});

// Recurring Expenses JavaScript
function showRecurringForm() {
    $('#addRecurringModal').modal('show');
}

function handleRecurringSubmit(event) {
    event.preventDefault();
    alert('Add Recurring functionality would be implemented here.\n\nThis requires the corresponding Flask route in your app.py:\n\n@app.route("/add_recurring", methods=["POST"])\ndef add_recurring():\n    # Handle recurring expense creation\n    pass');
    return false;
}

function processRecurring(id) {
    if (confirm('Process this recurring expense?')) {
        console.log('Process recurring expense:', id);
        alert('Process recurring functionality would be implemented here.\n\nThis requires the corresponding Flask route in your app.py:\n\n@app.route("/process_recurring/<int:recurring_id>")\ndef process_recurring(recurring_id):\n    # Handle recurring expense processing\n    pass');
    }
}

function editRecurring(id) {
    console.log('Edit recurring expense:', id);
    alert('Edit functionality would be implemented here.\n\nThis requires the corresponding Flask route in your app.py:\n\n@app.route("/edit_recurring/<int:recurring_id>")\ndef edit_recurring(recurring_id):\n    # Handle recurring expense editing\n    pass');
}

function deleteRecurring(id) {
    if (confirm('Delete this recurring expense? This cannot be undone.')) {
        console.log('Delete recurring expense:', id);
        alert('Delete functionality would be implemented here.\n\nThis requires the corresponding Flask route in your app.py:\n\n@app.route("/delete_recurring/<int:recurring_id>", methods=["POST"])\ndef delete_recurring(recurring_id):\n    # Handle recurring expense deletion\n    pass');
    }
}

function processAllDue() {
    if (confirm('Process all due recurring expenses?')) {
        console.log('Process all due expenses');
        alert('Process all due functionality would be implemented here.\n\nThis requires the corresponding Flask route in your app.py:\n\n@app.route("/process_all_due", methods=["POST"])\ndef process_all_due():\n    # Handle processing all due expenses\n    pass');
    }
}

function toggleFilters() {
    const filterCard = document.getElementById('filterCard');
    if (filterCard.style.display === 'none' || filterCard.style.display === '') {
        filterCard.style.display = 'block';
    } else {
        filterCard.style.display = 'none';
    }
}

function clearAllFilters() {
    document.querySelector('[name="search"]').value = '';
    document.querySelector('[name="category"]').value = '';
    document.querySelector('[name="sort"]').value = 'date_desc';
    document.getElementById('filterForm').submit();
}

// Auto-switch to recurring tab if needed
{% if request.endpoint == 'expenses' and request.args.get('tab') == 'recurring' %}
$(document).ready(function() {
    $('#recurring-tab').click();
});
{% endif %}
</script>
{% endblock %}
